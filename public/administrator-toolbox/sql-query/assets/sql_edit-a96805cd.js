import"./modulepreload-polyfill-3cfb730f.js";import{f as i}from"./config-87c9063f.js";class d{constructor(){this.doc=document,this.element_name,this.element_type,this.element_description,this.element_delete,this.element=this.create_one_line_li_element(),this.element.controller=this}create_one_line_li_element(){const e=this.doc.createElement("li"),n=this.doc.createElement("input");n.type="text",n.placeholder="sql占位符",n.dataset.name="占位符",e.append(n),this.element_name=n;const t=this.doc.createElement("input");t.type="text",t.placeholder="类型 string/int",t.dataset.name="类型",e.append(t),this.element_type=t;const o=this.doc.createElement("input");o.type="text",o.placeholder="描述",o.dataset.name="描述",e.append(o),e.append(o),this.element_description=o;const s=this.doc.createElement("button");return s.textContent="移除",s.dataset.name="移除",e.append(s),this.element_delete=s,e}get_data(){return{key:this.element_name.value,type:this.element_type.value,note:this.element_description.value}}}class _{constructor(e){this.doc=document,this.element=e,this.element.controller=this,this.total_sql_data_list,this.init()}async init(){this.total_sql_data_list=await this.get_sql_data_list(),this.render()}async get_sql_data_list(){return await(await i("../php/get_sql_data_list.php")).json()}render(){const e=document.createDocumentFragment();for(let n of this.total_sql_data_list){const t=this.create_one_line_li_element(n);e.append(t)}this.element.replaceChildren(e)}create_one_line_li_element(e){const n=this.doc.createElement("li"),t=this.doc.createElement("button");return t.textContent=e.name,t.dataset.name=e.name,t.sql_data=e,n.append(t),n}get_data(){return{key:this.element_name.value,type:this.element_type.value,note:this.element_description.value}}}function p(a){const e=new d;a.append(e.element)}async function h(a,e){const n={name:"功能名称",note:"详细说明",sql:"",params:[]},t=document.querySelector('#app > input[data-name="功能名称"]');n.name=t.value;const o=document.querySelector("#note");n.note=o.value;const s=document.querySelector("#sql");n.sql=s.value;const c=e.querySelectorAll("li");for(let r of c){const m=r.controller.get_data();n.params.push(m)}console.log(n);const l=JSON.stringify(n,null,"	");console.log(l),(await i("../php/insert_sql.php",{method:"POST",body:l})).ok?alert("插入成功"):alert("插入失败")}function u(a,e){switch(a.target.dataset.name){case"增加一个参数":p(e);break;case"保存此条sql":h(a,e);break}}function y(a){if(a.target.tagName!=="BUTTON")return 0;switch(a.target.dataset.name){case"移除":a.target.parentElement.remove();break}}function f(a){const e=a.target;e.style.height="",e.scrollHeight>e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}function g(){new _(document.querySelector("#function_list"));const a=document.querySelectorAll("textarea");for(const t of a)t.addEventListener("input",f);const e=document.querySelector("#app > ul");document.querySelector("div.toolbar").addEventListener("click",t=>u(t,e)),e.addEventListener("click",t=>y(t))}g();
